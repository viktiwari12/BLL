For beetter readalibility, the code is attached with the precious class only.